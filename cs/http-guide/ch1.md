# 🎯 Chapter 1: 인터넷 네트워크

<aside>
💡 웹, HTTP 전부 인터넷 네트워크 위에서 통신하기 때문에 인터넷 네트워크 망에 기반해서 동작하기 때문에 HTTP 학습을 위한 사전 기본학습이다.

</aside>

## 🍄 1. 인터넷 통신

- 인터넷에서 컴퓨터 둘은 어떻게 통신할까? 클라이언트 컴퓨터, 서버 컴퓨터가 옆에 붙어 있다면 연결을 통해 메시지를 주고 받을 수 있지만, 클라이언트와 서버 중간에는 인터넷이 있다.
- 클라이언트 컴퓨터와 서버 컴퓨터의 거리가 멀 경우 복잡한 인터넷 망을 통해 통신하게 되는데 인터넷이란 되게 복잡하다. 어떻게 이 복잡한 인터넷 망을 해쳐서 서버 컴퓨터에 도착할까? 이를 이해하려면 먼저 **IP(인터넷 프로토콜)**에 대한 이해가 필요하다.

## 🍄 2. IP(Internet Protocol)

- 복잡한 인터넷망에서 클라이언트 컴퓨터와 서버 컴퓨터가 통신하기 위해서는 클라이언트 컴퓨터와 서버 컴퓨터에 **IP 주소**가 필요하다.

### 🌻 2-1. IP 프로토콜의 역할

- 지정한 IP 주소(IP Address)에 데이터 전달
- 패킷(Packet)이라는 통신 단위로 데이터 전달
- IP 패킷 정보는 규칙이 있다. 패킷안에는 출발지 IP, 목적지 IP 등이 있다.

### 🌻 2-2. IP 프로토콜의 전달 방식

1. 클라이언트는 출발지 IP, 목적지 IP등이 들어있는 패킷을 인터넷 망에 던진다.
2. 인터넷 망이 이러한 패킷 정보를 해석해서 서버 컴퓨터(목적지 IP)로 전달한다.
3. 서버가 클라이언트가 전송한 데이터를 확인하고 클라이언트에게 응답한다.(서버 패킷 전달)

### 🌻 2-3. IP 프로토콜의 한계점

1. **비연결성**
    - 패킷을 받을 대상이 없거나 서비스 불능 상태여도 패킷 전송
2. **비신뢰성**
    - 중간에 패킷이 사라질 수 있다.
    - 패킷이 순서대로 안올수 있다.
3. **프로그램 구분**
    - 같은 IP를 사용하는 서버에서 통신하는 애플리케이션이 둘 이상일 수 있다.
4. **이러한 문제들을 해결해주는 것**
    - TCP 프로토콜

## 🍄 3. TCP, UDP

### 🌻 3-1. 프로토콜 계층

- 인터넷 프로토콜 스택의 4 계층
    - 애플리케이션 계층 - HTTP, FTP
    - 전송 계층 - TCP, UDP
    - 인터넷 계층 - IP
    - 네트워크 인터페이스 계층
- Hello, World 메시지 전송 순서
    1. 프로그램이 Hello, world! 메시지 생성(애플리케이션)
    2. SOCKET 라이브러리를 통해 전달(애플리케이션 계층 → OS 계층)
    3. TCP 정보 생성, 메시지 데이터 포함(전송 계층)
    4. IP 패킷 생성, TCP 데이터 포함(인터넷 계층)
    5. 네트워크 인터페이스를 통해 인터넷으로 나간다.(Ethernet fram을 포함)

### 🌻 3-2. 패킷

- 패킷이란 패키지(수화물)과 버킷(덩어리)를 합친 말이다.

### 🌻 3-3. TCP/IP 패킷 정보

- IP 패킷 안에는 TCP에 대한 정보가 들어간다.
- 출발지 PORT, 목적지 PORT, 전송 제어, 순서, 검증 정보 등이 들어간다.

### 🌻 3-4. TCP 특징

- 전송 제어 프로토콜(Transmission Control Protocol)
- 연결지향 - TCP 3 way handshake(가상 연결)
- 데이터 전달 보증
- 순서 보장
- 신뢰할 수 있는 프로토콜
- 현재는 대부분 TCP를 사용한다.

### 🌻 3-5. TCP 3 way handshake

- **SYN** : 접속 요청
- **ACK**: 요청 수락
- 순서
    1. 클라이언트에서 서버로 먼저 SYN 메시지를 보낸다.
    2. 서버에서 SYN+ACK 라는 메시지를 보낸다.
    3. 클라이언트는 서버로 ACK를 보낸다.
    4. 3 way handshake 과정이 끝난 후 데이터를 전송한다.
- 최근에는 최적화가 되어서 마지막 단계에서 ACK를 보낼 때 데이터를 함께 전송한다.
- 3 way handshake는 논리적으로 연결된것. 진짜 연결된 것이 아니다. 우리끼리만 연결이 됬다고 생각하자의 개념이다.

### 🌻 3-6. 데이터 전달 보증

- 데이터를 전송했을 때 받는 쪽에서 데이터를 잘 받았다고 응답해줌.

### 🌻 3-7. 순서 보장

- 순서
    1. 패킷1, 패킷2, 패킷3 순서로 전송
    2. 패킷1, 패킷3, 패킷2 순서로 도착
    3. 서버에서 클라이언트에게 패킷2부터 다시 보내라고 응답
- 순서 보장은 그냥 되는 것이 아니라 TCP 패킷에 전송 제어, 순서, 검증 정보 등이 들어가 있기 때문에 가능한 것이다.

### 🌻 3-8. UDP

- 사용자 데이터 그램 프로토콜(User Datagram Protocol)
- 하얀 도화지에 비유(기능이 거의 없음)
- 연결지향 ❌
- 데이터 전달 보증 ❌
- 순서 보장 ❌
- 데이터 전달 및 순서가 보장되지 않지만, 단순하고 **빠름**
- 정리
    - IP와 거의 같다. +**PORT** +**체크섬** 정도만 추가되었다.
    - 애플리케이션에서 추가 작업이 필요하다.
    - **PORT**는 하나의 IP에서 여러 애플리케이션을 사용할 때 구분해주는 역할을 한다.
    - **체크섬**은 이 메세지에 대해서 검증해주는 데이터.
- UDP는 최근에 각광을 받고 있다. **HTTP3**가 UDP 프로토콜을 사용한다.

## 🍄 4. PORT

### 🌻 4-1. 한번에 둘 이상 연결해야 하면?

- 예를 들어 클라이언트에서 게임, 화상통화, 웹 브라우저 요청을 하고 있다. 클라이언트로 부터 패킷이 전달되었는데 게임에서 사용하는건지, 화상통화에서 사용하는건지, 웹 브라우저에서 사용을 하는 것인지 구분이 안된다. 반대로 보낼 때도 마찬가지다. 이를 어떻게 구분할까?
- TCP/IP 패킷에는 출발지 PORT, 목적지 PORT가 있다.
- IP는 목적지 서버를 찾는 것이고, 서버 안에서 돌아가는 애플리케이션을 구분하는 것이 PORT이다.

### 🌻 4-2. 같은 IP 내에서 프로세스 구분

- 예
    - 게임 : 100.100.100.1:8090
    - 화상통화 : 100.100.100.1:21000
    - 웹 브라우저 : 100.100.100.1:10010
- 뒤에 있는 포트로 같은 IP 내에서 프로세스를 구분하며, 이는 패킷을 전달할 때와 패킷을 받을 때 모두 사용한다.

### 🌻 4-3. PORT 번호

- 0 ~ 65535 할당 가능
- 0 ~ 1023 : 잘 알려진 포트, 사용하지 않는 것이 좋다.
    - FTP : 20, 21
    - TELNET : 23
    - HTTP : 80
    - HTTPS : 443

## 🍄 5. DNS

- IP는 기억하기 어렵다. 주소를 어떻게 하나하나 모두 기억할까?
- IP는 변경될 수 있다. 내가 기억한 IP 주소와 달라진다면 접근을 할 수 없다.
- **DNS**는 도메인 네임 시스템(Domain Name System)의 약자로  도메인 명을 IP 주소로 변환하는 역할을 한다. 전화번호부를 생각하면 된다.

### 🌻 5-1. DNS 사용

- DNS 서버에는 도메인을 등록할 수 있다.

| 도메인 명 | IP |
| --- | --- |
| google.com | 200.200.200.2 |
| aaa.com | 210.210.210.3 |
- 순서
    1. 클라이언트는 도메인 `[google.com](http://google.com)` 에 접근한다.
    2. DNS 서버는 도메인명에 해당하는 IP 주소를 응답해준다.
    3. 클라이언트는 DNS 서버에서 받은 IP 주소로 접속한다.