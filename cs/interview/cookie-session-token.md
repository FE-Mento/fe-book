# 🎯 cookie, session token 차이점

<aside>
💡 [참고 링크](https://velog.io/@ahsy92/%EA%B8%B0%EC%88%A0%EB%A9%B4%EC%A0%91-Session%EA%B3%BC-Cookie-Token)

</aside>

## 🍄 쿠키(cookie)

- 쿠키는 특정 웹서버에 접속할 때 생성되는 정보를 담은 임시파일이다.
- 쿠키는 서버가 사용자의 웹 브라우저에 저장하는 데이터를 말한다.

### 🌻 쿠키의 사용목적

- 세션관리 : 로그인, 사용자 닉네임, 접속시간, 장바구니 등의 서버가 알아야할 정보들을 저장한다.
- 개인화 : 사용자마다 다르게 그 사람에 적절한 페이지를 보여줄 수 있다.
- 트래킹 : 사용자의 행동과 패턴을 분석하고 기록한다.

### 🌻 쿠키의 단점

- 방문했던 웹 사이트에 대한 정보 및 개인정보가 기록되기 때문에 보안에 취약하다. 이를 해소하기 위해 웹 브라우저 자체에 쿠키 거부 기능이 있다. 하지만 쿠키 거부가 브라우저에 설정되어 있으면 쿠키의 본래목적인 웹 브라우저와의 연결을 지속시키는 기능을 수행할 수 없는 경우가 발생한다.
- 서버가 가지고 있는 것이 아니라 사용자에게 저장되기 때문에 임의로 고치거나 지울 수 있고 가로채기도 쉬워 보안에 취약하다. 쿠키에 중요한 정보를 담는 것은 위험하다.

## 🍄 세션(Session)

- 서버에 임시로 저장한 파일을 세션이라 한다.
- 주로 중요한 데이터를 저장할 때 사용되고 브라우저가 종료될 때까지 유지 된다.

### 🌻 세션 장점

- 세션/쿠키 방식은 기본적으로 쿠키를 매개로 인증을 거친다. 여기서 쿠키는 세션 저장소에 담긴 유저 정보를 얻기 위한 열쇠라고 보면 된다. 따라서 쿠키가 담긴 HTTP 요청이 도중에 노출되더라도 쿠키 자체는 유의미한 값을 갖고 있지 않다.
- 사용자는 고유의 ID 값을 발급받게 된다. 서버에서는 쿠키값을 받았을 때 일일이 회원정보를 확인할 필요가 없고 어떤 회원인지 확인가능해서 서버의 자원에 접근하기 용이하다.

### 🌻 세션 단점

- 완벽한 보안은 없다.
- 이미 인증된 사용자의 HTTP 요층을 해커가 가로챘다면 그 안의 Cookie도 탈취 가능하다. 해커가 인증된 사용자의 Cookie를 실어 서버에 요청을 보내면 서버는 사용자인지 해커인지 구별할 방법이 없다.

### 🌻 세션 단점의 해결법

- HTTPS를 사용하면 된다. 서버와 클라이언트 간의 주고받는 정보를 암호화하여 요청을 탈취해도 정보를 읽을 수 없다.
- 세션에 유효시간을 지정한다.(일정 시간이 지나면 해당 클라이언트와 서버와의 세션을 끊는다)

## 🍄 토큰(Token)

- 토큰은 일종의 암호화된 접근 권한이다.
- 예를 들어 웹 사이트에 로그인 할 때 사용자가 아이디와 패스워드를 입력하면 서버는 이를 확인하고 사용자에게 유효한 사용자라는 토큰을 발행해준다. 그럼 사용자는 이 토큰을 가지고 웹 사이트에서 제공하는 여러 기능들을 이용할 수 있다.
- `JWT` 는 세션/쿠키와 함께 대표적인 인증수단이다. `JWT(Json Web Token)` 의 약자로 인증에 필요한 정보들을 암호화시킨 토큰을 뜻하며 토큰을 HTTP헤더에 실어 서버로 보낸다.

### 🌻 토큰의 장점

- 간편하다. Session/Cookie는 별도의 저장소 관리가 필요하다. 그러나 JWT는 발급한 후 검증만 하면 되기 때문에 추가 저장소가 필요 없다. Stateless한 서버를 만드는 입장에서는 강점이다.
- 확장성이 뛰어나다. Token 기반으로 하는 다른 인증 시스템에 접근이 가능하다. 예를 들어 Facebook, Google 로그인은 모두 토큰 기반으로 인증한다. 이에 선택적으로 이름이나 이메일 등을 받을 수 있는 권한도 추가할 수 있다.

### 🌻 토큰의 문제점

- 발급된 JWT에 대해서는 돌이킬 수 없다. Session/Cookie의 경우 만일 Cookie가 악의적으로 이용된다면, 해당 Session을 지워버리면 된다. 하지만 JWT의 경우 한번 발급되면 유효기간이 완료될 때까지 계속 사용이 가능하다. 따라서 악의적인 사용자는 유효기간이 지나기 전까지 정보를 털어갈 수 있다.
- Payload의 정보가 제한적이다. Payload는 따로 암호화 되지 않기 때문에 디코딩하면 누구나 정보를 확인할 수 있다.
- JWT의 길이가 길다. Session/Cookie 방식에 비해 JWT는 길이가 길다. 따라서 인증이 필요한 요청이 많아질 수록 서버의 지원낭비가 발생한다.

### 🌻 토큰 문제점의 해결법

- Access Token의 유효기간을 짧게 하고 `Refresh Token` 이라는 새로운 토큰을 발급한다. 그렇게 되면 `Access Token` 을 탈취당해도 상대적으로 피해를 줄일 수 있다.